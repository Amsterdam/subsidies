<div id="selectie" class="col-md-2"><br><label>Filter opties</label>
    <div oninput="getDataAndRender()" >
        <hr>
        <label>Jaar</label>
        <input id="fltrJaar"
              type="number" 
              maxlength="4" 
              value="2015"
              class="form-control"
              />
        <hr>
        <label>Ondergrens</label>
        <input id = 'fltrOndergrens'
              name="Ondergrens" 
              type="number" 
              maxlength="10" 
              value="0" 
              class="form-control"
              />

        <label>Bovengrens</label>
        <input id = 'fltrBovengrens'
              name="Bovengrens" 
              type="number" 
              maxlength="10" 
              value="9999999999"    
              />
        <hr>
        <label>Type</label>
        <input class="filter_button" id="a_button" type="checkbox" onchange="getDataAndRender()">Periodiek</input><br>
        <input class="filter_button" id="b_button" type="checkbox" onchange="getDataAndRender()">Eenmalig</input><br>   
    </div>
</div>
<div class="col-md-10">
    <div class="panel panel-default">
        <div class="panel-body" id="table_container">
        </div>
    </div>
</div>


<script>

    //var canvas = d3.select("#table_container").append("table");
    
    function render_table(data){
        <!-- variable to make the table sortable in 2 directions -->
        var sortAscending = true;        
 
        <!-- clears the existing table by removing it -->
        d3.selectAll("table").remove();

        <!-- select the table div on the site and add a table to it -->
        var table = d3.select("#table_container").append('table').attr("class", 'table');

        <!-- get the column headers from the data file-->
        //var titles = d3.keys(data[0]);
        var titles = ["Organisatieonderdeel",	"REGELINGNAAM",	"PROJECT_NAAM",	"Jaar",	"TYPE_PERIODICITEIT",	"BEDRAG_VERLEEND"];
       
        <!-- adds a table header row to the table and fills is with the data found in the titles varable -->
        var headers = table.append('thead')
                            .append('tr')
                            .selectAll('th')
                            .data(titles).enter()
                            .append('th')
                            .text(function (d) { return d; })
                            .style("width","10%")

                            <!-- sort the data by clicking on the column header -->
                            .on('click', function (d) {
                                   headers.attr('class', 'header');
                                   if (sortAscending) {
                                     rows.sort(function(a, b) { return d3.ascending(b[d], a[d]); });
                                     sortAscending = false;
                                     this.className = 'aes';
                                   } else {
                                     rows.sort(function(a, b) { return d3.descending(b[d], a[d]); });
                                     sortAscending = true;
                                     this.className = 'des';
                                   }

                               });


        <!-- add rows for all data records -->
        var rows = table.append('tbody')
                        .selectAll('tr')
                        .data(data).enter()
                        .append('tr');

        <!-- add cells to the table rows, for all fields in the data -->
          rows.selectAll('td')
            .data(function (d) {
                return titles.map(function (k) {    //k are the items in the column array, the function is returning value pairs (dictionary)
                    //console.log(k, { 'value': d[k], 'name': k});
                    return { 'value': d[k], 'name': k};
                });
            }).enter()
            .append('td')
            .attr('data-th', function (d) {
                return d.name;
            })
            .text(function (d) {
                return d.value;
            });    
        
    };
    
    function getDataAndRender(){
        var ssv = d3.dsv(";");
        
        var fltrJaar = d3.select("#fltrJaar").property("value");
        var fltrOndergrens = d3.select("#fltrOndergrens").property("value");
        var fltrBovengrens = d3.select("#fltrBovengrens").property("value");
        var fltrPeriodiek = d3.select("#a_button").property("checked");
        var fltrEenmalig = d3.select("#b_button").property("checked");
        
        ssv( "static/data/subsidie_out2.csv", type, function(error, data_csv) {
        
            var data = data_csv;
        
        <!-- implementation of the record filtering -->
            data = data.filter( function(row) { return row['SUBSIDIEJAAR'] == fltrJaar});
            data = data.filter( function(row) { return row['BEDRAG_VERLEEND'] >= fltrOndergrens});
            data = data.filter( function(row) { return row['BEDRAG_VERLEEND'] <= fltrBovengrens});
            
            if( fltrEenmalig && ! fltrPeriodiek ){
                data =  data.filter( function(row){ return row['TYPE_PERIODICITEIT'] === 'Eenmalig' });
            }
            if( ! fltrEenmalig && fltrPeriodiek ){
                data =  data.filter( function(row){ return row['TYPE_PERIODICITEIT'] === 'Periodiek' });
            }
            
            render_table(data);
        });
    };
    
    function type(d) {
      d.BEDRAG_VERLEEND = +d.BEDRAG_VERLEEND;
      d.BEDRAG_AANGEVRAAGD = +d.BEDRAG_AANGEVRAAGD; 
      d.SUBSIDIEJAAR = +d.SUBSIDIEJAAR;    
      return d;
    };

   getDataAndRender();
</script>



<html>
<head>
  <meta name=viewport content="width=device-width,initial-scale=1" >

  <link href="../../static/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" type="text/css" href="//cdn.datatables.net/1.10.12/css/jquery.dataTables.min.css">
    
  <script src="http://d3js.org/d3.v3.min.js"></script>
  <script src="http://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
  <script src="//cdn.datatables.net/1.10.12/js/jquery.dataTables.min.js"></script>
</head>

<body>
    
    <div id='wrapper' class='container'>
        <div id='base' class='row'>
            <div id='filter' class="col-md-2">
                
                <hr>
                <input type="text" id="bedragVanaf", value=2015>Minimaal
                <input type="text" id="bedragTot", value=2015>Maximaal
                <hr>
                <input type="number" id="jaar", value=2015>Jaar
                <hr>
                <input name='tijd' type="checkbox" id ='Periodiek'>Periodiek
                <input name='tijd' type="checkbox" id ='Eenmalig'>Eenmalig
                <hr>
                <input name='type' type="checkbox" id ='Directie Communicatie'>Directie Communicatie
                <input name='type' type="checkbox" id ='Diversiteit'>Diversiteit
                <input name='type' type="checkbox" id ='Duurzaamheid'>Duurzaamheid
                <input name='type' type="checkbox" id ='Economie'>Economie
                <input name='type' type="checkbox" id ='Gebiedspool Centrum'>Gebiedspool Centrum
                <input name='type' type="checkbox" id ='Gebiedspool Nieuw-West'>Gebiedspool Nieuw-West
                <input name='type' type="checkbox" id ='Gebiedspool Noord'>Gebiedspool Noord
                <input name='type' type="checkbox" id ='Gebiedspool Oost'>Gebiedspool Oost
                <input name='type' type="checkbox" id ='Gebiedspool West'>
                <input name='type' type="checkbox" id ='Gebiedspool Zuid'>
                <input name='type' type="checkbox" id ='Gebiedspool Zuidoost'>
                <input name='type' type="checkbox" id ='Gemeentebreed (algemeen)'>
                <input name='type' type="checkbox" id ='Jeugd'>
                <input name='type' type="checkbox" id ='Jongeren- en studentenhuisvesting'>
                <input name='type' type="checkbox" id ='Kunst en Cultuur'>
                <input name='type' type="checkbox" id ='ONBEKEND'>
                <input name='type' type="checkbox" id ='Onderwijs'>
                <input name='type' type="checkbox" id ='Openbare Orde en Veiligheid'>
                <input name='type' type="checkbox" id ='Participatie'>
                <input name='type' type="checkbox" id ='Ruimte'>
                <input name='type' type="checkbox" id ='Sport'>
                <input name='type' type="checkbox" id ='Wonen'>
                <input name='type' type="checkbox" id ='Zorg'>
                <hr>
                <!--  <input onchange="filterme()" type="checkbox" name="type" value="Periodiek">Periodiek
                  <input onchange="filterme()" type="checkbox" name="type" value="Eenmalig">Eenmalig-->
            </div>
            <div id='container' class='col-md-10' style="padding-right:100px">
            </div>
        </div>
    </div>
</body>
    
    <style>
        th{
            background-color: aquamarine;
        }
    </style>
    <script>
        
        
        
    
            /********
            *   this is done to give logical names to the table headers. Be aware that the lists must be the same length
            */
            var tableHeaders = ['Organisatie Onderdeel', 'Regeling', 'Project', 'Jaar', 'Type', 'Verleend bedrag'];
            var fileHeaders = ["ORGANISATIEONDERDEEL",	"REGELINGNAAM",	"PROJECT_NAAM",	"SUBSIDIEJAAR",	"TYPE_PERIODICITEIT",	"BEDRAG_VERLEEND"];
            var tanles;
            
            function populateTable(data){
                //console.log('received a data update', data.length, ' records');
                
                d3.select("#subsidieTable_wrapper").remove(); 
                
                // append the subsiditable
                var table = d3.select("#container").append("table").attr("id", "subsidieTable");

                // append the header row
                var headers = table.append('thead')
                                .append('tr')
                                .selectAll('th')
                                .data(tableHeaders).enter()
                                .append('th')
                                .text(function(d){return d; });

                var rows = table.append('tbody');

                /**********
                * the base of the table is drawn
                */

                var brows = rows.selectAll('tr')
                                .data(data).enter()
                                .append('tr'); 
                    
                    brows.selectAll('td')
                        .data(function (d) {
                            return fileHeaders.map(function (k) {    //k are the items in the column array, the function is returning value pairs (dictionary)
                            //console.log(k, { 'value': d[k], 'name': k});
                            return { 'value': d[k], 'name': k};
                            });
                        }).enter()
                        .append('td')
                        .text( function(d){ return d.value;});
                    
                $(document).ready(function() { 
                        var cTable = $('#subsidieTable').DataTable();
                                            
                        // Event listener to the two range filtering inputs to redraw on input
                        $('#fltrJaar').keyup( function() {cTable.draw(); } );
                        
                        $('#Periodiek').click( function() {cTable.draw(); });
                        $('#Eenmalig').click( function() {cTable.draw(); });
                    
                        $('#Directie Communicatie').click( function() {cTable.draw(); });
                        $('#Diversiteit').click( function() {cTable.draw(); });
                        $('#Duurzaamheid').click( function() {cTable.draw(); });
                        $('#Economie').click( function() {cTable.draw(); });
                        $('#Gebiedspool Centrum').click( function() {cTable.draw(); });
                        $('#Gebiedspool Nieuw-West').click( function() {cTable.draw(); });
                        $('#Gebiedspool Noord').click( function() {cTable.draw(); });
                        $('#Gebiedspool Oost').click( function() {cTable.draw(); });
                        $('#Gebiedspool West').click( function() {cTable.draw(); });
                        $('#Gebiedspool Zuid').click( function() {cTable.draw(); });
                        $('#Gebiedspool Zuidoost').click( function() {cTable.draw(); });
                        $('#Gemeentebreed algemeen').click( function() {cTable.draw(); });
                        $('#Jeugd').click( function() {cTable.draw(); });
                        $('#Jongeren- en studentenhuisvesting').click( function() {cTable.draw(); });
                        $('#Kunst en Cultuur').click( function() {cTable.draw(); });
                        $('#ONBEKEND').click( function() {cTable.draw(); });
                        $('#Onderwijs').click( function() {cTable.draw(); });
                        $('#Openbare Orde en Veiligheid').click( function() {cTable.draw(); });
                        $('#Participatie').click( function() {cTable.draw(); });
                        $('#Ruimte').click( function() {cTable.draw(); });
                        $('#Sport').click( function() {cTable.draw(); });
                        $('#Wonen').click( function() {cTable.draw(); });
                        $('#Zorg').click( function() {cTable.draw(); });
                    
                    });
                    
            };
            
            function getData(){
                
                var ssv = d3.dsv(';');
                ssv('../static/data/subsidie_out2.csv', type, function(error, data){
                    if( error ) throw error;
                    populateTable(data);    
                    
                    
                });
                
            };
            
            function type(d){
                d.SUBSIDIEJAAR = +d.SUBSIDIEJAAR;
                d.BEDRAG_AANGEVRAAGD = +d.BEDRAG_AANGEVRAAGD;
                d.BEDRAG_VERLEEND = +d.BEDRAG_VERLEEND;
                
                return d;
            };
            
            getData();
            
            
        $.fn.dataTable.ext.search.push( 
            function(settings, data, dataIndex){
                var returnValue = true;
                
                //var value = $("#fltrJaar").val();
                //    if( data[3] == value){ return true; }
                //    return false;
                
                var tijdFilter = $('input:checkbox[name="tijd"]:checked').map(function() {
                                    return this.id;
                                }).get()

                //console.log(data[0], tFilter, tFilter.length, tFilter.indexOf(data[0]));
                if( (tijdFilter.indexOf(data[4]) === -1) &&  !(tijdFilter.length === 0) ){
                    returnValue = false;
                }
                
                
                var typeFilter = $('input:checkbox[name="type"]:checked').map(function() {
                                return this.id;
                              }).get()
                
                //console.log(data[0], tFilter, tFilter.length, tFilter.indexOf(data[0]));
                if( ((typeFilter.indexOf(data[0]) === -1) &&  !(typeFilter.length === 0) )){
                    returnValue = false;
                }
                
                //var types = [$('input:checkbox[name="type"]:checked').map(function() {
                //                return this.id;
                //              }).get().join(',')];
                //    console.log(types)
                
                return returnValue;

                
        })

        /*
        function filterme() {
          //build a regex filter string with an or(|) condition
          var types = $('input:checkbox[name="type"]:checked').map(function() {
            return '^' + this.value + '\$';
          }).get().join('|');
          console.log(tanles);
          //filter in column 0, with an regex, no smart filtering, no inputbox,not case sensitive
          //otable.fnFilter(types, 0, true, false, false, false);
          tanles.fnFilter(types, 4, true, false, false, false);
        }
        */
        
        
    </script>

</html>